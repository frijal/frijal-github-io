<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Generator JSON Artikel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }
    h2 { text-align: center; color: #333; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea {
      width: 100%; padding: 8px; margin-top: 5px;
      border: 1px solid #ccc; border-radius: 4px;
    }
    button {
      margin-top: 15px; padding: 10px 15px;
      border: none; border-radius: 4px;
      cursor: pointer; color: white; background: #007BFF;
    }
    button:hover { background: #0056b3; }
    pre {
      background: #f4f4f4; padding: 10px;
      border-radius: 4px; overflow-x: auto; margin-top: 20px;
    }
    .file-load { margin: 15px 0; }
  </style>
</head>
<body>
  <h2>Generator JSON Artikel</h2>

  <!-- Load JSON lama -->
  <div class="file-load">
    <label>Load artikel.json lama</label>
    <input type="file" id="fileInput" accept=".json">
  </div>

  <!-- Form input -->
  <label>Judul</label>
  <input type="text" id="title" placeholder="Judul artikel" oninput="autoSlug()">

  <label>Slug (otomatis dari judul, bisa diubah)</label>
  <input type="text" id="slug" placeholder="contoh: pln-balikpapan">

  <label>Deskripsi</label>
  <textarea id="description" placeholder="Ringkasan artikel..."></textarea>

  <label>Tanggal</label>
  <input type="date" id="date">

  <label>Penulis</label>
  <input type="text" id="author" value="Fakhrul Rijal">

  <label>Kategori</label>
  <input type="text" id="category" placeholder="contoh: Perjalanan">

  <label>URL Gambar</label>
  <input type="url" id="image" placeholder="https://...jpg">

  <button onclick="tambahArtikel()">Tambah Artikel</button>
  <button onclick="downloadJSON()">Download JSON</button>

  <pre id="output">[]</pre>

  <script>
    let data = [];

    // Load file JSON lama
    document.getElementById("fileInput").addEventListener("change", function(e){
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(ev){
        try {
          data = JSON.parse(ev.target.result);
          document.getElementById("output").textContent = JSON.stringify(data, null, 2);
          alert("Berhasil memuat " + file.name);
        } catch (err) {
          alert("File JSON tidak valid!");
        }
      };
      reader.readAsText(file);
    });

    // Auto slug dari judul
    function autoSlug() {
      const title = document.getElementById("title").value;
      const slug = title.toLowerCase()
        .replace(/[^a-z0-9\s-]/g, "")
        .trim()
        .replace(/\s+/g, "-");
      document.getElementById("slug").value = slug;
    }

    // Tambah artikel baru
    function tambahArtikel() {
      const artikel = {
        slug: document.getElementById("slug").value.trim(),
        title: document.getElementById("title").value.trim(),
        description: document.getElementById("description").value.trim(),
        date: document.getElementById("date").value,
        author: document.getElementById("author").value.trim(),
        category: document.getElementById("category").value.trim(),
        image: document.getElementById("image").value.trim()
      };

      if (!artikel.slug || !artikel.title || !artikel.date) {
        alert("Slug, Judul, dan Tanggal wajib diisi!");
        return;
      }

      if (data.some(item => item.slug === artikel.slug)) {
        alert("Slug sudah ada, gunakan yang lain!");
        return;
      }

      data.push(artikel);
      document.getElementById("output").textContent = JSON.stringify(data, null, 2);

      // Reset form
      document.getElementById("title").value = "";
      document.getElementById("slug").value = "";
      document.getElementById("description").value = "";
      document.getElementById("date").value = "";
      document.getElementById("category").value = "";
      document.getElementById("image").value = "";
    }

    // Download JSON
    function downloadJSON() {
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "artikel.json";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
