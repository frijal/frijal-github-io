<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Uji Lengkap Manifest ‚Ä¢ PWA ‚Ä¢ SEO ‚Ä¢ Structured Data</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#0f172a; color:#e5e7eb; padding:20px; }
    h1 { color:#3b82f6; }
    h2 { color:#f97316; margin-top:24px; }
    pre { background:#1e293b; padding:10px; border-radius:8px; overflow-x:auto; }
    .ok { color:#22c55e; }
    .fail { color:#ef4444; }
    img { width:48px; height:48px; margin:4px; background:#fff; border-radius:6px; }
    section { margin-bottom:30px; }
  </style>
</head>
<body>
  <h1>üîç Uji Lengkap Manifest ‚Ä¢ PWA ‚Ä¢ SEO ‚Ä¢ Structured Data</h1>

  <section>
    <h2>1. Uji Manifest</h2>
    <div id="statusManifest">Memuat manifest...</div>
    <pre id="jsonManifest"></pre>
    <div id="iconsManifest"></div>
  </section>

  <section>
    <h2>2. Uji PWA</h2>
    <div id="statusPWA">Memuat manifest...</div>
    <ul id="checklistPWA"></ul>
    <div id="extraPWA"></div>
  </section>

  <section>
    <h2>3. Uji Meta Tag SEO</h2>
    <div id="statusMeta">Memuat meta tag...</div>
    <ul id="checklistMeta"></ul>
  </section>

  <section>
    <h2>4. Uji Structured Data</h2>
    <div id="statusSchema">Memuat structured data...</div>
    <pre id="jsonSchema"></pre>
  </section>

  <section>
    <h2>5. Deteksi Browser, OS, dan Lokasi</h2>
    <div id="clientInfo"></div>
  </section>

  <script>
    const manifestUrl = "https://frijal.github.io/site.webmanifest";

    // --- Uji Manifest + PWA ---
    fetch(manifestUrl)
      .then(r => { if (!r.ok) throw new Error("Gagal memuat manifest"); return r.json(); })
      .then(data => {
        document.getElementById("statusManifest").innerHTML = "‚úÖ Manifest berhasil dimuat";
        document.getElementById("jsonManifest").textContent = JSON.stringify(data, null, 2);
        if (data.icons) {
          const iconsDiv = document.getElementById("iconsManifest");
          iconsDiv.innerHTML = "<h3>Ikon:</h3>";
          data.icons.forEach(icon => {
            const img = document.createElement("img");
            img.src = icon.src;
            img.alt = icon.sizes;
            img.title = icon.sizes;
            iconsDiv.appendChild(img);
          });
        }
        // Checklist PWA
        const checklist = [];
        function check(prop) {
          if (data[prop]) checklist.push(`<li class="ok">‚úî ${prop} ada</li>`);
          else checklist.push(`<li class="fail">‚úñ ${prop} tidak ada</li>`);
        }
        ["name","short_name","start_url","display","theme_color","background_color","icons"].forEach(check);
        document.getElementById("checklistPWA").innerHTML = checklist.join("");
        // Extra PWA checks
        let extra = "";
        if (location.protocol === "https:") extra += "<p class='ok'>‚úî HTTPS aktif</p>";
        else extra += "<p class='fail'>‚úñ Tidak via HTTPS</p>";
        if ('serviceWorker' in navigator) extra += "<p>‚Ñπ Service Worker API tersedia, cek DevTools ‚Üí Application ‚Üí Service Workers</p>";
        else extra += "<p class='fail'>‚úñ Service Worker tidak tersedia</p>";
        if (data.display === "standalone") extra += "<p class='ok'>‚úî display=standalone</p>";
        if (data.icons && data.icons.some(i => i.sizes.includes("192x192"))) extra += "<p class='ok'>‚úî Ikon ‚â•192x192 ada</p>";
        document.getElementById("extraPWA").innerHTML = extra;
        document.getElementById("statusPWA").innerHTML = (data.name && data.icons && data.start_url)
          ? "üöÄ Aplikasi ini berpotensi installable sebagai PWA"
          : "‚ö† Masih ada properti yang kurang untuk PWA";
      })
      .catch(err => { document.getElementById("statusManifest").innerHTML = "‚ùå " + err.message; });

    // --- Uji Meta Tag SEO ---
    const required = [
      { selector: 'meta[name="description"]', label: "Description" },
      { selector: 'link[rel="canonical"]', label: "Canonical" },
      { selector: 'meta[property="og:title"]', label: "OG Title" },
      { selector: 'meta[property="og:description"]', label: "OG Description" },
      { selector: 'meta[property="og:image"]', label: "OG Image" },
      { selector: 'meta[property="og:type"]', label: "OG Type" },
      { selector: 'meta[property="og:url"]', label: "OG URL" },
      { selector: 'meta[property="og:site_name"]', label: "OG Site Name" },
      { selector: 'meta[name="twitter:card"]', label: "Twitter Card" },
      { selector: 'meta[name="twitter:title"]', label: "Twitter Title" },
      { selector: 'meta[name="twitter:description"]', label: "Twitter Description" },
      { selector: 'meta[name="twitter:image"]', label: "Twitter Image" },
      { selector: 'meta[itemprop="name"]', label: "Schema Name" },
      { selector: 'meta[itemprop="image"]', label: "Schema Image" },
      { selector: 'meta[name="viewport"]', label: "Viewport" }
    ];
    const checklistMeta = document.getElementById("checklistMeta");
    let okCount = 0;
    required.forEach(item => {
      const el = document.querySelector(item.selector);
      if (el) { okCount++; checklistMeta.innerHTML += `<li class="ok">‚úî ${item.label} ada</li>`; }
      else checklistMeta.innerHTML += `<li class="fail">‚úñ ${item.label} tidak ada</li>`;
    });
    document.getElementById("statusMeta").innerHTML = okCount === required.length
      ? "‚úÖ Semua meta tag penting sudah ada"
      : "‚ö† Beberapa meta tag masih kurang";

    // --- Uji Structured Data ---
    const schemaEl = document.querySelector('script[type="application/ld+json"]');
    if (schemaEl) {
      document.getElementById("statusSchema").innerHTML = "‚úÖ Structured data ditemukan";
      try {
        const json = JSON.parse(schemaEl.textContent);
        document.getElementById("jsonSchema").textContent = JSON.stringify(json, null, 2);
      } catch(e) {
        document.getElementById("jsonSchema").textContent = "‚ùå JSON tidak valid";
      }
    } else {
      document.getElementById("statusSchema").innerHTML = "‚ö† Tidak ada structured data (Schema.org)";
    }

        // --- Deteksi Browser/OS/IP ---
    function getBrowserInfo() {
      const ua = navigator.userAgent;
      if (ua.includes("Firefox")) return {name:"Firefox", icon:"https://upload.wikimedia.org/wikipedia/commons/a/a0/Firefox_logo%2C_2019.svg"};
      if (ua.includes("Edg")) return {name:"Edge", icon:"https://upload.wikimedia.org/wikipedia/commons/1/1f/Microsoft_Edge_logo_%282019%29.svg"};
      if (ua.includes("Chrome")) return {name:"Chrome", icon:"https://upload.wikimedia.org/wikipedia/commons/8/87/Google_Chrome_icon_%282011%29.png"};
      if (ua.includes("Safari")) return {name:"Safari", icon:"https://upload.wikimedia.org/wikipedia/commons/5/52/Safari_browser_logo.svg"};
      return {name:"Unknown", icon:""};
    }

    function getOSInfo(){
      const ua=navigator.userAgent.toLowerCase();
      if(/windows/.test(ua)) return {name:"Windows", icon:"https://upload.wikimedia.org/wikipedia/commons/5/5f/Windows_logo_-_2021.svg"};
      if(/mac/.test(ua)) return {name:"macOS", icon:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg"};
      if(/linux/.test(ua)) return {name:"Linux", icon:"https://upload.wikimedia.org/wikipedia/commons/a/af/Tux.png"};
      if(/android/.test(ua)) return {name:"Android", icon:"https://upload.wikimedia.org/wikipedia/commons/d/d7/Android_robot.svg"};
      if(/iphone|ipad|ipod/.test(ua)) return {name:"iOS", icon:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg"};
      return {name:"Unknown", icon:""};
    }

    const b = getBrowserInfo();
    const os = getOSInfo();
    document.getElementById("clientInfo").innerHTML = `
      <p><img src="${b.icon}" width="24"> Browser: ${b.name}</p>
      <p><img src="${os.icon}" width="24"> OS: ${os.name}</p>
      <p id="ipInfo">IP: ...</p>
    `;

    // Ambil IP publik via ipify, lalu detail lokasi via ipapi.co
    fetch('https://api.ipify.org?format=json&ipv4=true')
      .then(r => r.json())
      .then(({ ip }) => fetch(`https://ipapi.co/${ip}/json/`))
      .then(res => res.json())
      .then(data => {
        document.getElementById('ipInfo').innerHTML = 
          `IP: ${data.ip} (${data.city || 'Kota tidak diketahui'}, ${data.country_name || 'Negara tidak diketahui'}) 
           <img src="https://flagcdn.com/24x18/${String(data.country_code).toLowerCase()}.png">`;
      })
      .catch(() => {
        document.getElementById('ipInfo').textContent = 'IP: Tidak dapat diambil';
      });
  </script>
</body>
</html>

