<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daftar Isi Interaktif</title>
<style>
  body { font-family: 'Segoe UI', Arial; margin:0; padding-top:70px; background:#f2f2f2; color:#333; }
  h1 { text-align:center; margin-bottom:20px; font-size:2rem; }

  /* Marquee */
  #marquee-container { width:100%; background:#007BFF; color:white; overflow:hidden; white-space:nowrap; position:fixed; top:0; left:0; z-index:9999; padding:10px 0; font-size:14px; font-weight:bold; }
  #marquee-content { display:inline-block; padding-left:100%; animation:marquee 600s linear infinite; will-change:transform; }
  #marquee-container:hover #marquee-content { animation-play-state:paused; }
  #marquee-content a { color:white; text-decoration:none; margin-right:30px; transition: color 0.3s; }
  #marquee-content a:hover { color:yellow; text-decoration:underline; }
  @keyframes marquee { 0% { transform: translateX(0%); } 100% { transform: translateX(-100%); } }

  #search { width:80%; max-width:400px; padding:10px; font-size:16px; margin:15px auto; display:block; border-radius:6px; border:1px solid #ccc; }

    /* Expand/Collapse Button */
  #tocToggle { display:block; width:200px; margin:10px auto; padding:8px 12px; font-size:14px; font-weight:bold; border:none; border-radius:6px; cursor:pointer; background:#007BFF; color:white; }
  
  /* TOC */
  #toc { max-width:900px; margin:10px auto; }
  #totalCount { text-align:center; margin-top:20px; font-weight:bold; font-size:16px; padding:10px; background:#007BFF; color:white; border-radius:6px; }

  .category { margin:10px 0; border-radius:8px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.1); background:white; }
  .category-header { cursor:pointer; padding:10px 16px; font-weight:bold; display:flex; justify-content:space-between; align-items:center; transition:all 0.3s; color:white; }
  .toc-list { display:none; padding:0 16px; }
  .toc-item { display:flex; align-items:center; margin:4px 0; padding:4px 0; border-bottom:1px solid #f0f0f0; }
  .toc-title { flex:1; display:flex; align-items:center; justify-content:flex-start; gap:8px; flex-wrap: wrap; }
  .toc-title a { text-decoration:none; color:#333; transition:all 0.3s; font-weight:bold; position:relative; }
  .toc-title a.visited { color: gray; }
  .toc-title a::after { content:""; position:absolute; left:50%; bottom:-2px; transform:translateX(-50%); width:0; height:2px; background:#fff; transition:width 0.3s ease; }
  .toc-title a:hover::after { width:100%; }
  .label-new { background:#28a745; color:white; padding:2px 5px; border-radius:8px; }
  .label-visited { background:#6c757d; color:white; padding:2px 5px; border-radius:8px; }
  .badge { padding:2px 8px; border-radius:12px; font-size:12px; color:white; margin-left:8px; font-weight:bold; }

  /* Highlight fade-in */
  .highlight { background: yellow; color: black; animation:fadeIn 0.5s ease-in; }
  @keyframes fadeIn { from { background: transparent; } to { background: yellow; } }

  @media(max-width:500px){ #infoBar { flex-direction:column; gap:10px; } }

 /* Badge jumlah artikel di kategori TOC */
.category-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  font-weight: bold;
  cursor: pointer;
  color: white;
  border-radius: 6px;
}

.category-header .badge {
  background: #ffc107; /* kuning emas */
  color: #333;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
}

  
  /* Efek pada judul artikel TOC */
.toc-title a {
  position: relative;
  text-decoration: none;
  color: #333;
  font-weight: bold;
  transition: all 0.3s ease;
}

/* Efek hover: scale, shadow, gradient text */
.toc-title a:hover {
  transform: scale(1.05); /* sedikit membesar */
  color: transparent;
  background: linear-gradient(90deg, #ff7e5f, #feb47b);
  background-clip: text;
  -webkit-background-clip: text; /* untuk browser Webkit */
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

/* Efek underline animasi */
.toc-title a::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 0%;
  height: 2px;
  background: #007BFF;
  transition: width 0.3s ease;
  border-radius: 2px;
}

.toc-title a:hover::after {
  width: 100%;
}

/* Efek highlight saat diklik atau visited */
.toc-title a.visited {
  color: gray;
  text-decoration: none;
  opacity: 0.8;
}

</style>
</head>
<body>

<!-- Marquee -->
<div id="marquee-container"><div id="marquee-content">Memuat judul artikel...</div></div>

<div id="footerInfo" style="display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:20px;font-size:14px;text-align:center;margin:10px auto;max-width:900px;"></div>
  
<!-- Search -->
<input type="text" id="search" placeholder="Cari judul...">

<!-- Expand/Collapse TOC -->
<button id="tocToggle">Collapse TOC</button>

<!-- TOC -->
<div id="toc"></div>
<div id="totalCount">Total artikel: 0</div>

<script>
const gradientMap = {
  "Arch": "linear-gradient(90deg, #0078D4, #1E90FF)",
  "Debian": "linear-gradient(90deg, #B22222, #DC143C)",
  "Desktop": "linear-gradient(90deg, #2F4F4F, #696969)",
  "Kehidupan": "linear-gradient(90deg, #FFD700, #FFA500)",
  "Kerja": "linear-gradient(90deg, #2F4F4F, #708090)",
  "Kuliner": "linear-gradient(90deg, #DC143C, #FF6347)",
  "Multimedia": "linear-gradient(90deg, #008B8B, #48D1CC)",
  "NixOS": "linear-gradient(90deg, #00BFFF, #87CEFA)",
  "OpenSUSE": "linear-gradient(90deg, #3CB371, #90EE90)",
  "OS Linux": "linear-gradient(90deg, #4F4F4F, #A9A9A9)",
  "OS Windows": "linear-gradient(90deg, #00A3DA, #00C8F5)",
  "Redhat": "linear-gradient(90deg, #B22222, #FF4500)",
  "Religi": "linear-gradient(90deg, #008080, #5F9EA0)",
  "Repository": "linear-gradient(90deg, #696969, #B0C4DE)",
  "Slackware": "linear-gradient(90deg, #008B8B, #48D1CC)",
  "Jaringan": "linear-gradient(90deg, #FF8C00, #FFD700)",
  "Pemrograman": "linear-gradient(90deg, #006400, #2E8B57)",
  "Perangkat Keras": "linear-gradient(90deg, #778899, #B0C4DE)",
  "Keuangan": "linear-gradient(90deg, #008000, #32CD32)",
  "Lainnya": "linear-gradient(90deg, #C0C0C0, #DCDCDC)"
};

const visitedLinks = JSON.parse(localStorage.getItem("visitedLinks")||"[]");

async function loadTOC() {
  try {
    const res = await fetch("artikel.json");
    const data = await res.json();
    const toc = document.getElementById("toc");
    toc.innerHTML = "";

    const totalCount = document.getElementById("totalCount");

    // --- Kelompokkan data per kategori ---
    const grouped = {};
    Object.keys(data).forEach(cat => {
      grouped[cat] = data[cat].map(arr => ({
        title: arr[0],
        file: arr[1],
        category: cat
      }));
    });

    // --- Hitung total artikel ---
    const totalArticles = Object.values(grouped).reduce((sum, arr) => sum + arr.length, 0);
    totalCount.textContent = `Total artikel: ${totalArticles}`;

    // --- Urutkan kategori berdasarkan jumlah artikel terbanyak ---
    Object.keys(grouped)
      .sort((a, b) => grouped[b].length - grouped[a].length)
      .forEach(cat => {
        const catDiv = document.createElement("div");
        catDiv.className = "category";

        catDiv.innerHTML = `
          <div class="category-header">
            ${cat} <span class="badge">${grouped[cat].length}</span>
          </div>
          <div class="toc-list"></div>
        `;

        const catList = catDiv.querySelector(".toc-list");

        // --- Terapkan gradient dari gradientMap ---
        catDiv.querySelector(".category-header").style.background = gradientMap[cat] || gradientMap["Lainnya"];

        // --- Tambahkan item TOC ---
        grouped[cat].forEach((item, i) => {
          const el = document.createElement("div");
          el.className = "toc-item";
          el.dataset.text = item.title.toLowerCase();

          const a = document.createElement("a");
          a.href = `artikel/${item.file}`;
          a.target="_blank";
          a.textContent = `${i + 1}. ${item.title}`;

          const statusSpan = document.createElement("span");
          if (visitedLinks.includes(item.file)) {
            statusSpan.className = "label-visited";
            statusSpan.textContent = "sudah dibaca 👍";
            a.classList.add("visited");
          } else {
            statusSpan.className = "label-new";
            statusSpan.textContent = "📚 belum dibaca";
          }

          a.addEventListener("click", () => {
            if (!visitedLinks.includes(item.file)) {
              visitedLinks.push(item.file);
              localStorage.setItem("visitedLinks", JSON.stringify(visitedLinks));
              statusSpan.className = "label-visited";
              statusSpan.textContent = "sudah dibaca 👍";
              a.classList.add("visited");
            }
          });

          const titleDiv = document.createElement("div");
          titleDiv.className = "toc-title";
          titleDiv.appendChild(a);
          titleDiv.appendChild(statusSpan);
          el.appendChild(titleDiv);
          catList.appendChild(el);
        });

        // --- Toggle kategori individu ---
        catDiv.querySelector(".category-header").addEventListener("click", () => {
          catList.style.display = catList.style.display === "block" ? "none" : "block";
          updateTOCToggleText();
        });

        toc.appendChild(catDiv);
      });

    // --- Marquee ---
const m = document.getElementById("marquee-content");
const allArticles = Object.values(grouped).flat();

// fungsi shuffle (Fisher-Yates)
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

const shuffled = shuffle(allArticles);

m.innerHTML = shuffled
  .map(d => `<a href="artikel/${d.file}" target="_blank">${d.title}</a>`)
  .join(" • ");

    // --- Search ---
    document.getElementById("search").addEventListener("input", function () {
      const term = this.value.toLowerCase();
      let countVisible = 0;

      document.querySelectorAll(".category").forEach(category => {
        let catVisible = false;
        category.querySelectorAll(".toc-item").forEach(item => {
          const text = item.dataset.text;
          const link = item.querySelector("a");
          if (term && text.includes(term)) {
            item.style.display = "flex";
            catVisible = true;
            countVisible++;
            const regex = new RegExp(`(${term})`, "gi");
            link.innerHTML = link.textContent.replace(regex, '<span class="highlight">$1</span>');
          } else {
            item.style.display = term ? "none" : "flex";
            link.innerHTML = link.textContent;
            if (!term) countVisible++;
          }
        });
        category.style.display = catVisible ? "block" : (term ? "none" : "block");
        const tocList = category.querySelector(".toc-list");
        tocList.style.display = catVisible ? "block" : tocList.style.display;
      });

      totalCount.textContent = `Total artikel: ${countVisible}`;
      updateTOCToggleText();
    });

    // --- Tombol global Buka/Tutup ---
    let tocCollapsed = false;
    const tocToggleBtn = document.getElementById("tocToggle");

    function updateTOCToggleText() {
      const allCollapsed = Array.from(document.querySelectorAll(".toc-list"))
        .every(list => list.style.display === "none");
      tocCollapsed = allCollapsed;
      tocToggleBtn.textContent = tocCollapsed ? "Buka" : "Tutup";
    }

    tocToggleBtn.addEventListener("click", () => {
      tocCollapsed = !tocCollapsed;
      document.querySelectorAll(".toc-list").forEach(list => {
        list.style.display = tocCollapsed ? "none" : "block";
      });
      tocToggleBtn.textContent = tocCollapsed ? "Buka" : "Tutup";
    });

    // --- Inisialisasi tombol ---
    updateTOCToggleText();

  } catch (e) {
    console.error("Gagal load artikel.json:", e);
  }
}

  
loadTOC();

</script>

  <script>
// Objek untuk data konfigurasi dan utilitas
const config = {
    icons: {
        browser: {
            "Firefox": "https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg",
            "Chrome": "https://www.google.com/chrome/static/images/chrome-logo-m100.svg",
            "Edge": "https://edgestatic.azureedge.net/shared/cms/lrs1c69a1j/logos/9bf02dd94ea34924aa15548eef82ed24-png-w231.avif",
            "Safari": "https://help.apple.com/assets/67DB7CC050E88FB49F04A835/67DB7CC2865C40D04307837A/id_ID/c5fc04e9594cf6863af8713a08f5c512.png",
            "Unknown": "https://upload.wikimedia.org/wikipedia/commons/d/d9/Icon-round-Question_mark.svg"
        },
        os: {
            "Windows": "https://upload.wikimedia.org/wikipedia/commons/5/5f/Windows_logo_-_2012.svg",
            "macOS": "https://upload.wikimedia.org/wikipedia/commons/f/fa/MacOS_logo.svg",
            "Linux": "https://upload.wikimedia.org/wikipedia/commons/a/af/Tux.png",
            "Unknown": "https://upload.wikimedia.org/wikipedia/commons/d/d9/Icon-round-Question_mark.svg"
        },
        globe: "https://upload.wikimedia.org/wikipedia/commons/4/45/GDJ-World-Flags-Globe_.svg"
    },
    api: 'https://ipapi.co/json/'
};

// Fungsi utilitas
const getInfo = (regex, ua, name, type) => {
    const match = ua.match(regex);
    const version = match ? match[1] : 'N/A';
    return {
        name,
        version,
        icon: config.icons[type][name] || config.icons[type].Unknown
    };
};

const getBrowserInfo = () => {
    const ua = navigator.userAgent;
    if (ua.includes("Firefox")) return getInfo(/Firefox\/([0-9\.]+)/, ua, "Firefox", "browser");
    if (ua.includes("Chrome") && !ua.includes("Edg")) return getInfo(/Chrome\/([0-9\.]+)/, ua, "Chrome", "browser");
    if (ua.includes("Edg")) return getInfo(/Edg\/([0-9\.]+)/, ua, "Edge", "browser");
    if (ua.includes("Safari")) return getInfo(/Version\/([0-9\.]+)/, ua, "Safari", "browser");
    return getInfo(null, ua, "Unknown", "browser");
};

const getOSInfo = () => {
    const platform = navigator.platform.toLowerCase();
    if (platform.includes("win")) return {
        name: "Windows",
        icon: config.icons.os.Windows
    };
    if (platform.includes("mac")) return {
        name: "macOS",
        icon: config.icons.os.macOS
    };
    if (platform.includes("linux")) return {
        name: "Linux",
        icon: config.icons.os.Linux
    };
    return {
        name: "Unknown",
        icon: config.icons.os.Unknown
    };
};

// Fungsi utama
const initFooterInfo = async () => {
    const footer = document.getElementById('footerInfo');
    if (!footer) return;

    try {
        const response = await fetch(config.api);
        const data = await response.json();

        const browser = getBrowserInfo();
        const os = getOSInfo();
        const countryCode = data.country_code.toLowerCase();

        const flagImgHtml = `<img src="https://flagcdn.com/48x36/${countryCode}.png" alt="${data.country_name}" width="24" height="18" style="vertical-align:middle;border:1px solid #ccc;border-radius:2px;">`;

        footer.innerHTML = `
            <div class="info-item">
                <img src="${browser.icon}" width="16" height="16"> <span>${browser.name} ${browser.version}</span>
            </div>
            <div class="info-item">
                <img src="${os.icon}" width="16" height="16"> <span>${os.name}</span>
            </div>
            <div class="info-item">
                <img src="${config.icons.globe}" width="16" height="16"> <span>${data.ip} (${data.city}, ${data.region}, ${data.country_name})</span> ${flagImgHtml}
            </div>
        `;

        // Tambahkan event listener untuk efek hover
        document.querySelectorAll('.info-item').forEach(el => {
            el.style.cssText = 'display:flex;align-items:center;gap:6px;cursor:pointer;transition:transform 0.2s, color 0.2s;';
            el.addEventListener('mouseenter', () => {
                el.style.transform = 'scale(1.05)';
                el.style.color = '#007BFF';
            });
            el.addEventListener('mouseleave', () => {
                el.style.transform = 'scale(1)';
                el.style.color = 'inherit';
            });
        });

    } catch (err) {
        footer.textContent = 'Tidak dapat mengambil data IP';
        console.error(err);
    }
};

initFooterInfo();
</script>
 
</body>
</html>
