<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate JSON Artikel</title>
</head>
<body>
<h1>Generate artikel.json</h1>
<button id="generate">Generate JSON</button>
<pre id="output"></pre>

<script>
const folderArtikel = "artikel/";

async function generateJSON() {
  try {
    // Ambil daftar file HTML dari folder artikel
    const res = await fetch(folderArtikel);
    const text = await res.text();
    // Parsing href dari listing folder GitHub Pages (jika GitHub Pages menampilkan index)
    const parser = new DOMParser();
    const doc = parser.parseFromString(text, "text/html");
    const links = Array.from(doc.querySelectorAll("a"))
      .map(a => a.getAttribute("href"))
      .filter(h => h.endsWith(".html"));

    // Buat array JSON
    const data = links.map(file => {
      const title = file
        .replace(".html","")
        .replace(/[-_]/g," ")
        .replace(/\b\w/g, l => l.toUpperCase());
      // Tentukan kategori otomatis
      const category = title.toLowerCase().includes("linux") ? "OS/Linux" :
                       title.toLowerCase().includes("hijab") ? "Religi" :
                       "Lainnya";
      return { title, file, category };
    });

    document.getElementById("output").textContent = JSON.stringify(data, null, 2);
    console.log(data);
    alert("JSON berhasil dibuat! Silakan commit & push menggunakan GitHub Actions.");
  } catch(e) {
    console.error(e);
    alert("Gagal generate JSON");
  }
}

document.getElementById("generate").addEventListener("click", generateJSON);
</script>
</body>
</html>
