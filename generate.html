<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate artikel.json Otomatis</title>
<style>
body { font-family: Arial, sans-serif; padding:20px; background:#f5f5f5; }
h1 { text-align:center; }
textarea { width:100%; height:400px; padding:10px; font-family: monospace; font-size:14px; }
button { padding:10px 15px; font-size:16px; margin-top:10px; cursor:pointer; }
</style>
</head>
<body>

<h1>Generate artikel.json Otomatis</h1>
<p>JSON muncul di bawah. Download & push manual ke repo.</p>
<textarea id="jsonOutput" readonly></textarea>
<br>
<button id="downloadBtn">Download JSON</button>

<script>
// --- Fungsi kategori ---
function titleToCategory(title){
  const t = title.toLowerCase();
  const cats = [
    {name:"Arch", k:["manjaro", "cachy", "arch", "endeavouros", "artix", "parabola", "blackarch", "garuda"]},
    {name:"Debian", k:["debian", "ubuntu", "mint", "mx", "elementary", "puppy", "kali", "kubuntu", "xubuntu", "lubuntu", "zorin", "popos", "deepin", "tails"]},
    {name:"Desktop", k:["kde", "hyperland", "caja", "ukui", "pantheon", "deepin", "lxde", "budgie", "mate", "gnome", "cinnamon", "xfce", "desktop", "fluxbox", "openbox", "i3", "sway", "awesome", "dwm", "enlightenment"]},
    {name:"Kehidupan", k:["hidup", "uang", "dosa", "alasan", "bapak", "ibu", "anak", "kehidupan", "tidur", "sahabat", "teman", "sombong", "wanita", "pria", "perempuan", "laki", "silaturahim", "daily", "rutinitas", "bahagia", "sedih", "cinta", "emosi", "keluarga", "sosial", "masalah"]},
    {name:"Kerja", k:["kerja", "kantor", "dokumen", "strategi", "pdf", "psikotes", "karir", "bisnis", "proyek", "meeting", "wawancara", "resign", "gaji", "promosi", "lembur", "freelance", "startup"]},
    {name:"Kuliner", k:["resep", "makan", "minum", "bumbu", "kuliner", "masak", "restoran", "kafe", "jajanan", "sarapan", "makan siang", "makan malam", "diet"]},
    {name:"Multimedia", k:["video", "foto", "audio", "film", "ffmpeg", "imagemagick", "photoshop", "gimp", "audacity", "blender", "premiere", "davinci", "lightroom", "kdenlive", "shotcut"]},
    {name:"NixOS", k:["nixos","nix"]},
    {name:"OpenSUSE", k:["opensuse", "suse", "leap", "tumbleweed"]},
    {name:"OS Linux", k:["grub", "autoremove", "cron", "reinstall", "dd", "troubleshooting", "skrip", "rsync", "system", "sudo", "backup", "plugin", "ssh", "symlinks", "mount", "samba", "linux", "bootloader", "distro", "release", "rilis", "kernel", "cli", "shell", "bash", "zsh", "systemd", "init", "pacman", "yay", "apt-get", "dpkg", "yum", "dnf", "zypper", "aptitude"]},
    {name:"OS Windows", k:["windows", "windows10", "windows11", "powershell", "cmd", "registry", "boot", "update"]},
    {name:"Redhat", k:["fedora", "centos", "redhat", "rhel", "scientific linux", "alma", "rocky"]},
    {name:"Religi", k:["allah", "shalat", "sholat", "agama", "puasa", "nabi", "islam", "madinah", "religi", "ghibah", "muslim", "quran", "hadits", "dakwah", "doa", "surga", "neraka", "masjid"]},
    {name:"Repository", k:["repository", "dnf", "apt", "repo", "snap", "synaptic", "octopi", "flatpak", "netselect", "mirror", "reflector", "aur", "ppa", "github", "gitlab", "bitbucket", "dockerhub"]},
    {name:"Slackware", k:["slackware", "slac", "sbopkg"]},
    {name:"Jaringan", k:["jaringan", "internet", "wifi", "router", "modem", "ethernet", "ip", "dns", "firewall", "tcp", "udp", "http", "https", "proxy", "vpn", "port"]},
    {name:"Pemrograman", k:["pemrograman", "program", "coding", "javascript", "python", "php", "java", "c++", "c", "html", "css", "database", "sql", "mysql", "mongodb", "framework", "library", "api", "bug", "compiler", "debugging"]},
    {name:"Perangkat Keras", k:["perangkat keras", "hardware", "cpu", "gpu", "ram", "hardisk", "ssd", "motherboard", "power supply", "monitor", "keyboard", "mouse", "printer", "usb", "driver"]},
    {name:"Keuangan", k:["keuangan", "investasi", "saham", "crypto", "bitcoin", "uang", "bank", "tabungan", "kredit", "pinjaman", "pajak", "anggaran", "ekonomi"]}
  ];
  return (cats.find(c=>c.k.some(k=>t.includes(k)))||{name:"Lainnya"}).name;
}

// --- Konfigurasi repo GitHub Pages publik ---
const owner = "frijal";   // ganti dengan username GitHub
const repo = "frijal.github.io";   // ganti dengan nama repo
const folder = "artikel";   // folder artikel

async function generateJSON(){
  try {
    // Ambil daftar file di folder artikel via GitHub API
    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${folder}`;
    const res = await fetch(apiUrl);
    const files = await res.json();

    const htmlFiles = files.filter(f => f.name.endsWith(".html"));

    const result = [];
    for(const f of htmlFiles){
      try{
        const htmlText = await fetch(f.download_url).then(r=>r.text());
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlText,'text/html');
        const title = doc.querySelector("title")?.innerText || f.name;
        const category = titleToCategory(title);
        result.push({title, file: f.name, category});
      }catch(e){
        console.warn("Gagal membaca file:", f.name);
        result.push({title: f.name, file: f.name, category:"Lainnya"});
      }
    }

    const jsonStr = JSON.stringify(result, null, 2);
    document.getElementById("jsonOutput").value = jsonStr;

  } catch(err){
    console.error("Gagal mengambil daftar file:", err);
    document.getElementById("jsonOutput").value = "Error: " + err.message;
  }
}

// Download JSON
document.getElementById("downloadBtn").addEventListener("click",()=>{
  const blob = new Blob([document.getElementById("jsonOutput").value], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "artikel.json";
  a.click();
  URL.revokeObjectURL(url);
});

// Jalankan otomatis
generateJSON();
</script>

</body>
</html>
