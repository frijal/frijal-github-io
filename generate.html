<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate artikel.json Otomatis</title>
<style>
body { font-family: Arial; padding:20px; background:#f9f9f9; }
h1 { color:#007BFF; }
textarea { width:100%; height:300px; font-family: monospace; margin-top:10px; }
button { padding:10px 20px; font-size:16px; margin-top:10px; cursor:pointer; }
</style>
</head>
<body>

<h1>Generate artikel.json Otomatis</h1>
<p>Semua file di <code>/artikel/list.txt</code> akan diproses.</p>
<button id="generateBtn">Generate JSON</button>
<h2>Hasil JSON:</h2>
<textarea id="result" readonly></textarea>

<script>
// --- Tentukan kategori berdasarkan judul ---
function titleToCategory(title){
  const t = title.toLowerCase();
  const cats = [
    {name:"Arch", k:["manjaro","cachy","arch"]},
    {name:"Debian", k:["debian","ubuntu","mint","mx","elementary","puppy","kali","kubuntu","xubuntu"]},
    {name:"Desktop", k:["kde","hyperland","caja","ukui","pantheon","deepin","lxde","budgie","mate","gnome","cinnamon","xfce","desktop"]},
    {name:"Kehidupan", k:["hidup","uang","dosa","alasan","kehidupan","tidur","sahabat","teman","sombong","wanita","pria","perempuan","laki","silaturahim","daily"]},
    {name:"Kerja", k:["kerja","kantor","dokumen","strategi","pdf","psikotes","karir"]},
    {name:"Kuliner", k:["resep","makan","minum","bumbu","kuliner"]},
    {name:"Multimedia", k:["video","foto","audio","film","ffmpeg","imagemagick"]},
    {name:"NixOS", k:["nixos"]},
    {name:"OpenSUSE", k:["opensuse"]},
    {name:"OS Linux", k:["grub","autoremove","cron","reinstall","dd","troubleshooting","skrip","rsync","system","sudo","backup","plugin","ssh","symlinks","mount","samba","linux","bootloader","distro","release","rilis"]},
    {name:"OS Windows", k:["windows"]},
    {name:"Redhat", k:["fedora","centos"]},
    {name:"Religi", k:["allah","shalat","sholat","agama","puasa","nabi","islam","madinah","religi","ghibah"]},
    {name:"Repository", k:["repository","dnf","apt","repo","snap","synaptic","octopi","flatpak","netselect","mirror","reflector"]},
    {name:"Slackware", k:["slackware"]}
  ];
  return (cats.find(c=>c.k.some(k=>t.includes(k)))||{name:"Lainnya"}).name;
}

document.getElementById("generateBtn").addEventListener("click", async () => {
  const result = [];
  
  try {
    // 1. Ambil list.txt
    const listRes = await fetch("artikel/list.txt");
    const text = await listRes.text();
    const files = text.trim().split(/\n/).map(f=>f.trim()).filter(f=>f);

    // 2. Loop semua file untuk ambil title
    for(const f of files){
      try{
        const res = await fetch("artikel/"+f);
        const html = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html,"text/html");
        const title = doc.querySelector("title")?.innerText || f;
        const category = titleToCategory(title);
        result.push({title, file: f, category});
      } catch(e){
        console.warn("Gagal fetch:", f);
        result.push({title:f, file:f, category:"Lainnya"});
      }
    }

    // 3. Tampilkan JSON
    document.getElementById("result").value = JSON.stringify(result,null,2);
  } catch(err){
    alert("Gagal membaca list.txt: "+err);
  }
});
</script>

</body>
</html>
